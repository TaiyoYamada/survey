# Benchmarking of Different Optimizers in the Variational Quantum Algorithms for Applications in Quantum Chemistry

**読了日:** 2026/02/20
**学会・年:** arXiv 2023年
**引用キー:** singh2023benchmarking

**keywords:** Variational Quantum Algorithms，Classical Optimizers，NISQ，Quantum Noise


**この論文の概要**
本論文は、量子化学計算に応用される**変分量子アルゴリズム（VQA）において、古典的な最適化アルゴリズムがどのように機能するかを包括的にベンチマーク評価**した研究である。勾配ベース、勾配フリー、量子ハードウェア特化型の多様なオプティマイザを使用し、H2、LiH、BeH2、H2O、HFという5つの分子を対象にシミュレーションを行っている。理想的な量子シミュレータだけでなく、ショットノイズや**実際の量子デバイス（IBM Cairo）のノイズを含んだ現実的なシミュレーション**環境を用いて、基底状態エネルギー、解離エネルギー、双極子モーメントの計算精度と収束性を比較している。

**先行研究と比べてどこがすごいか**
これまでの研究でも、変分量子線形ソルバーや量子機械学習の分野での最適化手法のベンチマークは存在した。また量子化学問題に関するベンチマークも一つ存在したが、それは「特定の少数の勾配フリーオプティマイザ」のみに焦点を当てたものであった。本研究の優れた点は、**多種多様な最適化手法（勾配ベース、勾配フリー、量子特化型）を網羅的に比較**している点と、理想的な条件だけでなく**「実際のNISQ（ノイズあり中規模量子）デバイスを想定したノイズ環境下」で評価**を行っている点である。これにより、実機を利用する上でどのオプティマイザを選択すべきかの実践的な指標を提供している。

**技術や手法のキモはどこか**
*   **VQE（変分量子固有値ソルバー）とUCC（ユニタリー結合クラスター）アンザッツの採用**: フェルミ粒子系のハミルトニアンを量子ビット空間に変換し、VQE回路のアンザッツとして電子相関を高精度に扱えるUCCを使用している。
*   **3つの最適化手法のカテゴリ分け**: オプティマイザを大きく「勾配ベース（CG、SLSQP、SPSAなど）」「勾配フリー（POWELL、COBYLAなど）」「量子ハードウェア特化型（AQGD、NFT）」の3種類に分類し、同一の計算リソース（最大100イテレーション）内で評価している。
*   **評価指標の多角化**: 単にエネルギーだけでなく、基底状態エネルギー誤差（$∆gs$）、解離エネルギー誤差（$∆de$）、および化学結合の記述に重要な双極子モーメントの平均二乗誤差（$∆MSE_{dipole}$）の3つのパラメータを評価基準としている。

**どうやって有効だと検証したか**
5つの異なる分子モデルを用い、Numpy固有値ソルバーによる**厳密な古典的計算結果（Exact Energy）を正解データとしてVQEの出力と比較**することで検証している。
検証は以下の3段階のシミュレータ環境で行われた。
1.  **理想的な状態ベクトルシミュレータ**（ノイズなし）
2.  **ノイズありQASMシミュレータ**（ショットノイズのみ）
3.  **IBM Cairoデバイスのノイズモデルを組み込んだQASMシミュレータ**（現実のハードウェアを模倣）

**【「ノイズに強い/弱い」の評価基準について】**
本研究では、オプティマイザのノイズ耐性を測るために、**3つの評価指標（基底状態エネルギー、解離エネルギー、双極子モーメント）の「平均誤差」に基づく相対的なパフォーマンス・ランキング**を用いている。
具体的には、「理想的な環境での順位」を横軸に、「ノイズ環境（IBM Cairoのノイズモデル）での順位」を縦軸にとった分布図を作成し、以下のように分類して評価を下している。
*   **ノイズに弱い（Noise susceptible）**: 理想環境では誤差が小さく上位（Efficient）だったにもかかわらず、ノイズ環境になると相対的な順位が大きく下落してしまう手法（例：CG、SLSQP、L_BFGS_Bなど）。
*   **ノイズに強い（Noise resistant）**: 理想環境での成績にかかわらず、ノイズ環境下でも順位を維持する、あるいは他が崩れる中で相対的に上位に食い込む手法（例：SPSA、POWELL、COBYLA、GDなど）。

**議論はあるか**
検証の結果、ノイズの有無によってオプティマイザの有効性が大きく変わるという重要な議論がなされている。
*   **ノイズ耐性に基づく最適な手法の明確化**: 前述の評価基準に照らすと、理想環境で最高性能を示した勾配ベース手法（CG、SLSQPなど）はノイズに極めて敏感であり、実用性に欠けることが判明した。一方で、**SPSA、POWELL、COBYLAはノイズ環境下でも安定した性能を維持する「ノイズに強い」手法**であり、現在のNISQデバイスにおける最適な選択肢であると結論付けられている。
*   **ノイズに強い理由の考察**: SPSAやPOWELL、COBYLAがノイズに強いのは、特定の固定されたパラメータ値での勾配に依存せず、「ランダムな摂動（SPSA）」「複数の共役ベクトル（POWELL）」「多項式関数による補間（COBYLA）」を用いて、複数のパラメータ値で損失関数を評価する（空間を多角的に探索する）アーキテクチャであるため、これが量子ノイズの悪影響を相殺している可能性が高いと指摘されている。
*   **量子特化型オプティマイザのアンザッツ依存性**: 最新の量子特化型オプティマイザであるAQGDやNFTは、全体的に成績が振るわなかった。論文では、これらが**「単一量子ビット回転ゲート」のパラメータシフト則に基づく解析的勾配を前提としているため、2電子励起を含むUCCアンザッツとの相性が悪い**ことを指摘している。実際、1量子ビット回転のみを用いたカスタムアンザッツ（TwoLocal）に変更すると、劇的に精度が向上することが示されており、オプティマイザとアンザッツの適合性について深い議論がなされている。
*   また、ノイズに強いとされるSPSAはランダムな摂動を用いるため、理想環境においては複数回の実行結果を平均化しないと正しいポテンシャルエネルギー曲線に近づきにくいという固有の課題も指摘されている。

**次に読むべき論文は**
1.  **他のVQA最適化手法のベンチマーク研究**: X. Bonet-Monroig et al. "Performance comparison of optimization methods on variational quantum algorithms" (2021) は、本論文でも言及されている量子化学計算における勾配フリーオプティマイザの先行ベンチマークである。
2.  **解析的勾配（パラメータシフト則）に関する理論的論文**: AQGDなどの基礎となっている、量子回路上の勾配計算に関する論文（M. Schuld et al. "Evaluating analytic gradients on quantum hardware" や Mitarai et al. "Quantum circuit learning"）を読むことで、なぜUCCアンザッツで解析的勾配の計算が失敗したのかの数学的背景がわかる。
3.  **ノイズ環境に強いオプティマイザの詳細研究**: 今回ノイズ耐性が高いとされた「SPSA」や「POWELL」のハイパーパラメータ調整に関する研究や、実機でこれらを最適に活用するための手法（本論文の結論部分でも、これらの手法のさらなる調整が有望であると言及されている）。